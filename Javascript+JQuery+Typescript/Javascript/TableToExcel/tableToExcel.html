<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HTML Table Export to Excel</title>
  <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"></script>
</head>
<body>
  <h1>tableToExcel Demo</h1>
  <p>Exporting the W3C Example Table</p>
  <p>同时也将HTML表格的格式拷贝到excel中</p>
  <button id="myButtonControlID" onclick="tableToExcel('tablename', 'name', 'myfile.xls')">Export Table data into Excel</button>
  <p>dsfjksdlkfhdskjfsdakhlfjsdlkfjsadlkf</p>
  <p>dsfjksdlkfhdskjfsdakhlfjsdlkfjsadlkf</p><p>dsfjksdlkfhdskjfsdakhlfjsdlkfjsadlkf</p><p>dsfjksdlkfhdskjfsdakhlfjsdlkfjsadlkf</p>
  <p>dsfjksdlkfhdskjfsdakhlfjsdlkfjsadlkf</p>
  <div id="divTableDataHolder">
      <title>Demo for huge data</title>
      <table id="myTable">
          <thead>
              <tr><th colspan="5">Demoe By <a href="http://codePattern.net/blog">CodePattern.net</a></th></tr>
          </thead>
          <tbody>
            <tr>
              <td>Anil Kumar</td><td>2012</td><td>Delhi</td><td>India</td><td><img src='http://codepattern.net/Blog/pics/CodepatternLogoN.png' alt=''/></td>
            </tr>
            <tr><td>abc</td><td>12</td><td>Delhi</td><td>India</td><td>Earth</td></tr>
            <tr><td>abc</td><td>12</td><td>Delhi</td><td>India</td><td>Earth</td></tr>
            <tr><td>abc</td><td>12</td><td>Delhi</td><td>India</td><td>Earth</td></tr>
            <tr><td>abc</td><td>12</td><td>Delhi</td><td>India</td><td>Earth</td></tr>
          </tbody>
      </table>
  </div>
  <script>
  var tableHTML = $('#divTableDataHolder').html();
  let uri = 'data:application/vnd.ms-excel;base64,', 
  template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><title></title><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>', 
  base64 = function(s) { return window.btoa(decodeURIComponent(encodeURIComponent(s))) },         
  format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
  
  var ctx = {worksheet: "name" || 'Worksheet', table: tableHTML}
  
	var file = new Blob([tableHTML], {type:"application/vnd.ms-excel"});
	var url = URL.createObjectURL(file);
	var a = $("<a />", {
	    href: url,
	    download: "filename.xls"
	  }).appendTo("body").get(0).click();
  $(a).remove();
  </script>
</body>
</html>
